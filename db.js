// Generated by CoffeeScript 1.3.3
(function() {
  var Echo, ObjectId, Schema, mongoose;

  mongoose = require('mongoose');

  if (process.env.MONGOLAB_URI) {
    mongoose.connect(process.env.MONGOLAB_URI);
  } else {
    mongoose.connect('mongodb://localhost/echotron');
  }

  Schema = mongoose.Schema;

  ObjectId = Schema.ObjectId;

  exports.Echo = Echo = mongoose.model('Echo', new Schema({
    title: String,
    author: String,
    repository: String,
    homepage: String,
    type: String,
    content: String
  }));

  Echo.prototype.toSlimJSON = function() {
    var json;
    json = this.toJSON();
    json.id = json._id;
    delete json._id;
    json.revision = json.__v;
    delete json.__v;
    delete json.content;
    json.path = "/echoes/" + this.type + "/" + this.title + ".js";
    return json;
  };

}).call(this);
